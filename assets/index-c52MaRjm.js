(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&c(i)}).observe(document,{childList:!0,subtree:!0});function e(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(n){if(n.ep)return;n.ep=!0;const a=e(n);fetch(n.href,a)}})();const d="image/jpeg",o=.3,b=async(t,r,e)=>{const c=y(t),n=r||.001;if(s(c))return await v(c,n,e);if(T(c))return await U(c,n,e);throw new Error("Unsupported URL, only HTTP and Blob URLs are supported")},y=t=>{if(typeof t=="string")return t;if(!s(t.src))throw new Error("Cannot find the video source URL");return t.src},s=t=>{if(t.startsWith("http://")&&!t.startsWith("http://localhost"))throw new Error("HTTP cannot be used");return t.startsWith("https://")||t.startsWith("http://localhost")},T=t=>t.startsWith("blob:"),v=(t,r,e)=>new Promise(c=>{const n=h(L(t,r));n.addEventListener("seeked",async()=>{var u;const a=m(f(n,e==null?void 0:e.size));a.drawImage(n,0,0,a.canvas.width,a.canvas.height);const i=await g(a.canvas,(e==null?void 0:e.format)||d,(e==null?void 0:e.quality)||o),l=URL.createObjectURL(i);(u=e==null?void 0:e.onBlobCreated)==null||u.call(e,{blob:i,blobUrl:l,thumbnailPosition:r}),c(l)})}),L=(t,r)=>{const e=new URL(t);return e.hash=`t=${r}`,e.toString()},U=(t,r,e)=>new Promise(c=>{const n=h(t);n.addEventListener("seeked",async()=>{var u;await new Promise(w=>setTimeout(w,100));const a=m(f(n,e==null?void 0:e.size));a.drawImage(n,0,0,a.canvas.width,a.canvas.height);const i=await g(a.canvas,(e==null?void 0:e.format)||d,(e==null?void 0:e.quality)||o),l=URL.createObjectURL(i);(u=e==null?void 0:e.onBlobCreated)==null||u.call(e,{blob:i,blobUrl:l,thumbnailPosition:r}),c(l)}),n.addEventListener("loadedmetadata",()=>{n.currentTime=r})}),h=t=>{const r=document.createElement("video");return r.src=t,r.crossOrigin="anonymous",r.preload="metadata",r},m=({width:t,height:r})=>{const e=document.createElement("canvas");e.width=t,e.height=r;const c=e.getContext("2d");if(!c)throw new Error("Failed to get 2d context");return c},f=(t,r)=>{if(!r)return{width:t.videoWidth,height:t.videoHeight};if(r.width&&r.height)return r;const e=t.videoWidth/t.videoHeight;if(r.width)return{width:r.width,height:r.width/e};if(r.height)return{width:r.height*e,height:r.height};throw new Error("Invalid size option")},g=(t,r,e)=>new Promise(c=>t.toBlob(n=>{if(!n)throw new Error("Failed to create a blob");c(n)},r,e)),E=document.querySelector("input#file-input"),P=document.querySelector("input#time-input"),R=document.querySelector("button#generate-button"),q=document.querySelector("section#thumbnail-container"),C=document.querySelector("template#thumbnail-template");R.addEventListener("click",async()=>{var a;const t=(a=E.files)==null?void 0:a[0];if(!t){alert("Please select a file");return}const r=URL.createObjectURL(t),e=t.name,c=Number(P.value),n=await b(r,c,{format:"image/jpeg",quality:.3,size:{width:320}});q.appendChild(S(n,c,e))});const S=(t,r,e)=>{const c=C.content.cloneNode(!0),n=c.querySelector("img");n.src=t;const a=c.querySelector("p");return a.textContent=`Time: ${r}s (${e})`,c};
